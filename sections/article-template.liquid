<script
  type="application/json"
  data-section-type="article-template"
  data-section-id="{{ section.id }}"
>
</script>

{% paginate article.comments by 100 %}
  {% comment %} Check to see if sidebar should be enabled {% endcomment %}
  {% if section.blocks.size > 0 %}
    {% assign sidebar = true %}
  {% else %}
    {% assign sidebar = false %}
  {% endif %}

  {% if section.settings.featured_image == 'banner' %}
    {% assign show_caption = true %}
  {% endif %}

  {% if article.image and section.settings.featured_image == 'banner' %}
    {%
      render 'template-banner',
      image: article.image,
      background_style: section.settings.caption_content_background,
      wide_display: section.settings.wide_display,
      banner_title: article.title,
      show_caption: show_caption,
    %}
  {% endif %}

  <section class="section">
    <div class="blog-article__main sidebar-enabled--{{ sidebar }} {% if template.suffix=="new_article_template" %}container1{% else %}container{% endif %} content">
      <div class="has-sidebar-option">
        <div class="{% if template.suffix=="new_article_template" %}container1{% else %}container{% endif %}">
          {% if template.suffix=="new_article_template" %}<div class="new_article_inner_content">{% endif %}
           <div class="breadcrumb breadcrumb-pagination-wrapper is-flex {% if section.settings.blog_breadcrumb and section.settings.blog_pagination == blank %}is-justify-left{% elsif section.settings.blog_breadcrumb == blank and section.settings.blog_pagination %}is-justify-right{% else %}is-justify-space-between{% endif %} one-whole column">
            <script type="application/ld+json">
              {
                "@context": "https://schema.org",
                "@type": "BreadcrumbList",
                "itemListElement": [
                  {
                    "@type": "ListItem",
                    "position": 1,
                    "item": {
                      "@id": "{{ shop.url }}",
                      "name": "{{ 'general.breadcrumbs.home' | t }}"
                    }
                  },
                  {
                    "@type": "ListItem",
                    "position": 2,
                    "item": {
                      "@id": "{{ blog.url }}",
                      "name": "{{ blog.title }}"
                    }
                  }
                ]
              }
            </script>

            {% if section.settings.blog_breadcrumb %}
              <div class="breadcrumb_text">
                <a href="{{ routes.root_url }}" title="{{ shop.name | escape }}">
                  <span>{{ 'general.breadcrumbs.home' | t }}</span>
                </a>&nbsp;<span class="icon-slash">/</span>
                <a href="{{ blog.url }}" title="{{ blog.title | escape }}">
                  <span>{{ blog.title }}</span>
                </a>
              </div>
            {% endif %}

            {% if section.settings.blog_pagination %}
              <div class="article-pagination">
                {% if blog.next_article %}
                  {{ 'blogs.article.previous_article_html' | t | link_to: blog.next_article }}
                {% endif %}

                {% if blog.previous_article and blog.next_article %}
                  &nbsp;<span class="icon-slash">/</span>
                {% endif %}

                {% if blog.previous_article %}
                  {{ 'blogs.article.next_article_html' | t | link_to: blog.previous_article }}
                {% endif %}
              </div>
            {% endif %}
          </div>

          {% unless article.image and section.settings.featured_image == 'banner' %}
            <div class="one-whole column article_content_blog_1">
              <h1 class="align_left article_title">{{ article.title }}</h1>
              <div class="feature-divider"></div>
            </div>
          {% endunless %}

          <div class="one-whole column">
            <p class="blog_meta">
              {% if section.settings.blog_byline %}
                <span><a href="/search?type=article&q={{ article.author }}">{% if template.suffix=="new_article_template" %} Post{% endif %} {{ a.author }}{{ 'blogs.article.by_author' | t: author: article.author }}</a></span>
              {% endif %}

              {% if section.settings.blog_date %}
                <span>{{ article.published_at | date: format: "month_day_year" }}</span>
              {% endif %}

              {% if section.settings.read_time %}
                {% render 'include-read-time' %}
              {% endif %}

              {% if section.settings.blog_tags %}
                <div class="blog_meta tags">
                  {% for tag in article.tags %}
                    <span>
                      <a href="{{ shop.url}}/blogs/{{ blog.handle }}/tagged/{{ tag | handleize }}" title="{{ blog.title }} {{ 'blogs.general.tagged' | t }} {{ tag | escape }}">{{ tag }}</a>
                    </span>
                  {% endfor %}
                </div>
              {% endif %}

              {% if section.settings.blog_comment_count %}
                {% if settings.disqus_enabled %}
                  <span>
                    <a href="{{ article.url }}#disqus_thread" data-disqus-identifier="{{ article.id }}" class="disqus-comment-count">{{ 'blogs.counts.comments_with_count' | t: count: 0 }}</a>
                  </span>
                {% elsif article.comments_enabled? and article.comments_count > 0 %}
                  <span>
                    <a href="{{ article.url }}#comments">{{ 'blogs.counts.comments_with_count' | t: count: article.comments_count }}</a>
                  </span>
                {% endif %}
              {% endif %}
            </p>
          </div>
          {% if template.suffix=="new_article_template" %}</div>{% endif %}
          <div class="article_content one-whole column {% if template.suffix=="new_article_template" %}container{% endif %}">
            {% if article.image and section.settings.featured_image == 'content' %}
              {%
                render 'image-element',
                image: article.image,
                alt: article.image.alt,
              %}
            {% endif %}
           {% if template.suffix =="new_article_template" %}<div class="inner_content">{% endif %}
         
            {%- assign h2_headings = article.content | split: '<h2>' -%}
            {%- if h2_headings.size > 1 -%}
              <div id="table-of-contents" class="floating-toc" style="display:none;">
                <h5 class="content-title">Contents</h5>
                <ul>
                  {%- for heading in h2_headings -%}
                    {%- assign heading_parts = heading | split: '</h2>'  -%}
                    {%- if heading_parts.size > 1 -%}
                      <li>
                       <a href="#{{ heading_parts[0] | handleize | remove:'span-' | remove:'-span'  }}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="8" height="13" viewBox="0 0 8 13" fill="none">
                          <path d="M7.04723 6.45888C7.04961 6.7771 6.92926 7.08321 6.71264 7.30988L2.09261 12.1456C1.98609 12.261 1.85833 12.3534 1.71677 12.4174C1.57521 12.4814 1.42269 12.5157 1.26811 12.5183C1.11354 12.5208 0.959996 12.4916 0.816449 12.4324C0.672903 12.3732 0.542227 12.2851 0.432045 12.1733C0.321863 12.0614 0.234382 11.9281 0.174707 11.7811C0.115032 11.6341 0.084357 11.4763 0.0844734 11.317C0.0845898 11.1576 0.115495 10.9999 0.175384 10.853C0.235274 10.7062 0.32295 10.5731 0.433295 10.4615L4.23673 6.48052L0.372439 2.55856C0.158619 2.33387 0.0389354 2.03166 0.0391653 1.71702C0.0393952 1.40237 0.15952 1.10046 0.373668 0.876315C0.587815 0.65217 0.878852 0.523722 1.18409 0.518637C1.48933 0.513553 1.78436 0.632237 2.00562 0.849129L6.69957 5.61313C6.91966 5.83643 7.04471 6.14065 7.04723 6.45888Z" fill="#D9D9D9"/>
                        </svg>
                        <span>{{ heading_parts[0] | strip_html }}</span>
                       </a>
                      </li>
                    {%- endif -%}
                  {%- endfor -%}
                </ul>
              </div>
            {%- endif -%}
<div id="table-of-contents" class="floating-toc"><h5 class="content-title">Contents</h5><ul></ul></div>
            <div class="rte has-padding-top blog_inner_content">
              {{ article.content }}
            </div>

            {% if template.suffix =="new_article_template" %}
              {% if section.settings.blog_additional_posts and blog.articles_count > 1 %}
                <div class="related_articles">      
                  {%
                    render 'blog-sidebar',
                    blog_handle: blog.handle
                  %}
                </div>
             {% endif %}
           {% endif %}

            {% if template.suffix =="new_article_template" %}</div>{% endif %}
          </div>

          {% if section.settings.blog_author or section.settings.display_social_buttons %}
            <div class="author_share_wrap one-whole column">
              {% if section.settings.blog_author %}
                <div class="blog_author">
                  <img src="//1.gravatar.com/avatar/{{ article.user.email | md5 }}?s=160&r=G" alt="{{ article.author }}"/>

                  <div class="author_bio">
                    <h6>{{ article.author }}</h6>
                    <p>{{ article.user.bio }}</p>
                  </div>
                </div>
              {% endif %}

              {% if section.settings.display_social_buttons %}
                <div class="blog_share meta">
                  {%
                    render 'social-buttons',
                    context: 'article'
                  %}
                </div>
              {% endif %}
            </div>
          {% endif %}

          <div id="comments"></div>

          {% if settings.disqus_enabled %}
            <div class="one-whole column">
              <div id="disqus_thread"></div>

              <script>
                var disqus_config = function () {
                  this.page.url = "{{ canonical_url }}";
                  this.page.identifier = "{{ article.id }}";
                };

                (function() {
                  var d = document, s = d.createElement('script');
                  s.src = '//{{ settings.disqus_shortname }}.disqus.com/embed.js';
                  s.setAttribute('data-timestamp', +new Date());
                  (d.head || d.body).appendChild(s);
                  })();
              </script>

              <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
          {% elsif blog.comments_enabled? %}
            {% if article.comments_count > 0 %}
              <div class="one-whole column">
                <h4>{{ 'blogs.comments.response_count' | t: count: article.comments.size }}</h4>
              </div>

              {% for comment in article.comments %}
                <div
                  class="
                    one-whole
                    column
                    blog__comment
                  "
                  id="comment-{{ comment.id }}"
                >
                  <div class="blog__comment-author">
                    <div class="blog__comment-author-image">
                      <img src="//1.gravatar.com/avatar/{{ comment.email | md5 }}?s=80&r=G" alt="{{ comment.author }}" />
                    </div>

                    <div class="blog__comment-author-bio">
                      <h6>{{ comment.author }}</h6>
                      <p class="meta">
                        <span class="label">{{ comment.created_at | date: format: "month_day_year" }}</span>
                      </p>
                      {{ comment.content }}
                    </div>
                  </div>
                </div>
              {% endfor %}
            {% endif %}

            <div class="one-whole column">
              {%
                render 'pagination',
                paginate: paginate,
              %}

              <div id="new-comment"></div>

              <h4>{{ 'blogs.comments.title' | t }}</h4>

              {% if blog.moderated? %}
                <p><em>{{ 'blogs.comments.moderated' | t }}</em></p>
              {% endif %}

              {% render 'comment-form' %}
            </div>
          {% endif %}
{% unless template.suffix =="new_article_template" %}{% endunless %}
          {% if section.settings.blog_additional_posts and blog.articles_count > 1 %}
            <div class="container"><div class="one-whole column article_inner_related">
              <!--<hr />-->
              <h2>Related Articles</h2>
            </div>

            {%- assign article_found = false -%}

            {% for a in blog.articles limit: 4 %}
              {%- assign skip_article = false -%}

              {% if article_found == false and forloop.last %}
                {%- assign skip_article = true -%}
              {% endif %}

              {% if article.id == a.id %}
                {%- assign article_found = true -%}
                {%- assign skip_article = true -%}
              {% endif %}

              {% unless skip_article %}
                <div class="one-third column medium-down--one-whole article article-related">
                  {% if a.image %}
                    <a href="{{ a.url }}" title="{{ a.title | escape }}">
                      {%
                        render 'image-element',
                        image: a.image,
                        alt: a.image.alt,
                      %}
                    </a>
                  {% endif %}

                  <h5 class="sub_title">
                    <a href="{{ a.url }}" title="{{ a.title | escape }}">{{ a.title }}</a>
                  </h5>
                 {% unless template.suffix =="new_article_template" %}
                  <p class="blog_meta">
                    {% if section.settings.blog_byline %}
                      <span>{{ 'blogs.article.by_author' | t: author: a.author }}</span>
                    {% endif %}

                    {% if section.settings.blog_date %}
                      <span>{{ a.published_at | date: format: "month_day_year" }}</span>
                    {% endif %}

                    {% if section.settings.read_time %}
                      {%
                        render 'include-read-time',
                        article: a,
                      %}
                    {% endif %}

                    {% if settings.disqus_enabled %}
                      <span>
                        <a href="{{ a.url }}#disqus_thread" data-disqus-identifier="{{ a.id }}" class="disqus-comment-count">{{ 'blogs.counts.comments_with_count' | t: count: 0 }}</a>
                      </span>
                    {% elsif section.settings.blog_comment_count and a.comments_count > 0 %}
                      <span>
                        <a href="{{ a.url }}#comments">{{ 'blogs.counts.comments_with_count' | t: count: a.comments_count }}</a>
                      </span>
                    {% endif %}
                  </p>

                  {% if section.settings.blog_tags %}
                    <div class="blog_meta tags">
                      {% for tag in a.tags %}
                        <span><a href="{{ shop.url}}/blogs/{{ blog.handle }}/tagged/{{ tag | handleize }}" title="{{ blog.title | escape }} {{ 'blogs.general.tagged' | t }} {{ tag | escape }}">{{ tag }}</a></span>
                      {% endfor %}
                    </div>
                  {% endif %}
                  {% endunless %}
                 <div class="blog_meta tags">
                      {% for tag in a.tags %}
                        <span><a href="{{ shop.url}}/blogs/{{ blog.handle }}/tagged/{{ tag | handleize }}" title="{{ blog.title | escape }} {{ 'blogs.general.tagged' | t }} {{ tag | escape }}">{{ tag }}</a></span>
                      {% endfor %}
                    </div>

                  {% if a.excerpt != blank %}
                    <div class="excerpt">{{ a.excerpt }}</div>
                  {% endif %}

                  {% if section.settings.read_more_link %}
                    <a
                      href="{{ a.url }}"
                      title="{{ a.title | escape }}"
                      class="
                        {% if settings.read_more_style == 'button' %}
                          blog__read-more-button global-button global-button--text
                        {% else %}
                          read-more-link
                        {% endif %}
                      "
                    >
                      {{ 'blogs.general.continue_reading_html' | t }}
                    </a>
                  {% endif %}
                </div>
              {% endunless %}
            {% endfor %}
          {% endif %}
            </div>
        </div>
      </div>
{% unless template.suffix=="new_article_template" %}
    {%
      render 'blog-sidebar',
      blog_handle: blog.handle,
    %}
{% endunless %}
  </section>
{% endpaginate %}

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "articleBody": "{{ article.content | strip_html | escape }}",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ shop.url }}{{ page.url }}"
    },
    "headline": "{{ article.title }}",
    {% if article.excerpt != blank %}
      "description": "{{ article.excerpt | strip_html | escape }}",
    {% endif %}
    {% if article.image %}
      {% assign image_size = article.image.width | append: 'x' %}
      "image": [
        "https:{{ article | img_url: image_size }}"
      ],
    {% endif %}
    "datePublished": "{{ article.published_at | date: '%Y-%m-%dT%H:%M:%SZ' }}",
    "dateCreated": "{{ article.created_at | date: '%Y-%m-%dT%H:%M:%SZ' }}",
    "dateModified": "{{ article.updated_at | date: '%Y-%m-%dT%H:%M:%SZ' }}",
    "author": {
      "@type": "Person",
      "name": "{{ article.author }}"
    },
    "publisher": {
      "@type": "Organization",
      {% assign image_size = settings.og_image_fallback.width | append: 'x' %}
      "logo": {
        "@type": "ImageObject",
        "height": "{{ settings.og_image_fallback.height }}",
        "url": "https:{{ settings.og_image_fallback | img_url: image_size }}",
        "width": "{{ settings.og_image_fallback.width }}"
      },
      "name": "{{ shop.name }}"
    }
  }
  </script>

{% schema %}
{
  "name": "Blog post",
  "class": "shopify-section--article-template under-menu",
  "settings": [
    {
      "type": "select",
      "id": "featured_image",
      "label": "Featured image",
      "options": [
        {
          "value": "banner",
          "label": "Display as banner"
        },
        {
          "value": "content",
          "label": "Display above content"
        },
        {
          "value": "none",
          "label": "Hidden"
        }
      ]
    },
    {
      "type": "header",
      "content": "Banner"
    },
    {
      "type": "paragraph",
      "content": "These settings only apply to the “Featured image” when it is displayed as a banner."
    },
    {
      "type": "checkbox",
      "id": "wide_display",
      "label": "Wide display",
      "default": true
    },
    {
      "type": "select",
      "id": "caption_content_background",
      "label": "Text contrast technique",
      "default": "original",
      "info": "Improve legibility by applying a contrast technique to your banner’s text.",
      "options": [
        {
          "value": "original",
          "label": "None"
        },
        {
          "value": "darken_bg",
          "label": "Darken banner image"
        },
        {
          "value": "text_box",
          "label": "Solid box"
        },
        {
          "value": "translucent_text_box",
          "label": "Translucent box"
        }
      ]
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "checkbox",
      "id": "blog_breadcrumb",
      "label": "Show breadcrumb links",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "blog_pagination",
      "label": "Show next blog post link",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "blog_tags",
      "label": "Show blog post tags"
    },
    {
      "type": "checkbox",
      "id": "blog_byline",
      "label": "Show author byline"
    },
    {
      "type": "checkbox",
      "id": "read_time",
      "label": "Show estimated read time",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "blog_date",
      "label": "Show date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "blog_author",
      "label": "Show author bio"
    },
    {
      "type": "checkbox",
      "id": "display_social_buttons",
      "label": "Show social media share icons",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "blog_comment_count",
      "label": "Show comment count",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "about_author",
      "label": "About Author",
      "default": true
    },
    {
      "type": "header",
      "content": "Related blog posts"
    },
    {
      "type": "checkbox",
      "id": "blog_additional_posts",
      "label": "Show related blog posts",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "read_more_link",
      "label": "Show continue reading link",
      "default": true
    },
    {
      "type": "header",
      "content": "Sidebar"
    },
    {
      "type": "paragraph",
      "content": "Create a sidebar by adding content blocks."
    },
    {
      "type": "checkbox",
      "id": "toggle",
      "label": "Collapse sidebar content",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "post_tags",
      "name": "Blog post tags",
      "limit": 1
    },
    {
      "type": "menu",
      "name": "Menu",
      "settings": [
        {
          "type": "link_list",
          "id": "custom_menu_linklist",
          "label": "Menu"
        }
      ]
    },
    {
      "type": "newsletter",
      "name": "Newsletter sign up form",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "newsletter_title",
          "label": "Heading",
          "default": "Subscribe"
        },
        {
          "type": "richtext",
          "id": "newsletter_text",
          "label": "Subheading",
          "default": "<p>Sign up to get the latest on sales, new releases and more …</p>"
        }
      ]
    },
    {
      "type": "newsletter-two",
      "name": "Newsletter two",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "newsletter_two_title",
          "label": "Heading",
          "default": "Subscribe"
        },
        {
          "type": "html",
          "id": "newsletter_two_text",
          "label": "Content"
        },
        {
          "type": "richtext",
          "id": "newsletter_two_content",
          "label": "Bottom Content",
          "default": "<p>Sign up to get the latest on sales, new releases and more …</p>"
        }
      ]
    },
    {
      "type": "addition_post",
      "name": "Related post",
      "settings": [
        {
          "type": "checkbox",
          "id": "blog_additional_posts1",
          "label": "Show related blog posts",
          "default": false
        }
      ]
    },
    {
      "type": "about-author",
      "name": "About Author",
      "limit": 1
    },
    {
      "type": "page",
      "name": "Page",
      "settings": [
        {
          "type": "page",
          "id": "content_page",
          "label": "Page"
        }
      ]
    },
    {
      "type": "recent_posts",
      "name": "Recent blog posts",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "blog_post_count",
          "label": "Display blog posts",
          "default": "10",
          "options": [
            {
              "value": "2",
              "label": "2"
            },
            {
              "value": "5",
              "label": "5"
            },
            {
              "value": "10",
              "label": "10"
            }
          ]
        }
      ]
    },
    {
      "type": "search",
      "name": "Search form",
      "limit": 1
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Heading"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Text area can be used for details about blog authors or general information.</p>"
        }
      ]
    }
  ]
}

{% endschema %}