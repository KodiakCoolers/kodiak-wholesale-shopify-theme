{% comment %}
Quote Configurator Block - Adapted from quote_popup.liquid
This is an inline version without modal functionality
{% endcomment %}

<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0"
/>
<link
  rel="stylesheet"
  href="{{ "quote-configurator-block.css" | asset_url }}"
/>

<script
  src="https://code.jquery.com/jquery-3.6.1.min.js"
  integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
  crossorigin="anonymous"
  defer
></script>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
  crossorigin="anonymous"
  defer
></script>
<script>
  let fleece = "{{ product.metafields.custom.fleece }}";
  let design_files ="{{product.metafields.custom.design_files}}";
</script>
<script
  src="{{ "quote-configurator-block.js" | asset_url }}"
  defer
></script>
<script type="application/json" id="product_json">{{ product | json }}</script>
<script id="stock_json">
  let variantStock = {};
  {% for variant in product.variants %}
    variantStock[{{- variant.id -}}] = {{ variant.inventory_quantity }};
  {% endfor %}
</script>

<div class="quote-configurator-block" {{ block.shopify_attributes }}>
  <div class="quote-configurator-content">
    <h2 class="section-title">ENTER CUSTOM PRINT DETAILS</h2>
    
    <div class="print-details-section">
          <!-- Type of print is always screen printing, so hide this section -->
          <input type="hidden" name="type" value="screen" />
      <!-- Ink Colors Section -->
      <div class="ink-colors-section">
        <h3 class="section-heading">Select the number of ink colors in your design.</h3>
        <div class="color-selectors">
          <select name="colorFront" id="colorFront" onchange="chooseColorsFront(this.value)">
            <option value="0">No Front Design</option>
            <option value="1" selected>1 Front Print Color</option>
            <option value="2">2 Front Print Colors</option>
            <option value="3">3 Front Print Colors</option>
            <option value="4">4 Front Print Colors</option>
            <option value="5">5 Front Print Colors</option>
          </select>
          
          <select name="colorBack" id="colorBack" onchange="chooseColorsBack(this.value)">
            <option value="0" selected>No Back Design</option>
            <option value="1">1 Back Print Color</option>
            <option value="2">2 Back Print Colors</option>
            <option value="3">3 Back Print Colors</option>
            <option value="4">4 Back Print Colors</option>
            <option value="5">5 Back Print Colors</option>
          </select>
        </div>
      </div>

      <!-- Upload Section -->
      <div class="upload-section">
        <h3 class="section-heading">Upload your best design files. Max file size 10MB.</h3>
        <p class="upload-subtitle">Vector files preferred. We'll create proofs for your review before it prints.</p>
        
        <!-- Front Design Upload -->
        <div class="upload-box" id="front-upload-box">
          <h4 class="upload-title">Upload Front Design</h4>
          <div class="file-drop-zone" id="front-drop-zone">
            <input type="file" id="frontDesignUpload" accept="image/*,.ai,.eps,.pdf,.psd" multiple style="display: none;">
            <div class="upload-content" onclick="document.getElementById('frontDesignUpload').click();">
              <button type="button" class="upload-btn">Choose file</button>
              <span class="upload-text">or drop file to upload</span>
            </div>
            <div class="file-preview" id="front-file-preview"></div>
          </div>
        </div>
        
        <!-- Back Design Upload -->
        <div class="upload-box" id="back-upload-box" style="display: none;">
          <h4 class="upload-title">Upload Back Design</h4>
          <div class="file-drop-zone" id="back-drop-zone">
            <input type="file" id="backDesignUpload" accept="image/*,.ai,.eps,.pdf,.psd" multiple style="display: none;">
            <div class="upload-content" onclick="document.getElementById('backDesignUpload').click();">
              <button type="button" class="upload-btn">Choose file</button>
              <span class="upload-text">or drop file to upload</span>
            </div>
            <div class="file-preview" id="back-file-preview"></div>
          </div>
        </div>
      </div>

      <!-- Location Selectors -->
      <div class="location-selectors">
        <!-- Front Design Location -->
        <div class="location-section" id="front-location-section">
          <h3 class="section-heading">Where do you want your front design to go?</h3>
          <div class="radio-options">
            <label class="radio-option">
              <input type="radio" name="frontLocation" value="full-front" checked>
              <span class="radio-label">Full Front (Large and Centered)</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="frontLocation" value="left-chest">
              <span class="radio-label">Left Chest (Smaller)</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="frontLocation" value="other">
              <span class="radio-label">Other (please specify below)</span>
            </label>
          </div>
        </div>
        
        <!-- Back Design Location -->
        <div class="location-section" id="back-location-section" style="display: none;">
          <h3 class="section-heading">Where do you want your back design to go?</h3>
          <div class="radio-options">
            <label class="radio-option">
              <input type="radio" name="backLocation" value="full-back" checked>
              <span class="radio-label">Full Back (large and centered)</span>
            </label>
            <label class="radio-option">
              <input type="radio" name="backLocation" value="other">
              <span class="radio-label">Other (please specify below)</span>
            </label>
          </div>
        </div>
      </div>

      <!-- Color Selector (single color) -->
      <div class="color-selector-section">
        <h3 class="section-heading">Choose product color</h3>
        <select id="bundleColorSelect">
          {% if product.options_by_name['Color'] %}
            {% for c in product.options_by_name['Color'].values %}
              <option value="{{ c | escape }}" {% if forloop.first %}selected{% endif %}>{{ c }}</option>
            {% endfor %}
          {% else %}
            <option value="Default" selected>Default</option>
          {% endif %}
        </select>
      </div>

      <!-- Sizes Section -->
      <div class="sizes-section" id="sizes-section">
        <h3 class="section-heading">ENTER YOUR SIZES</h3>
        {% assign minimum_qty = product.metafields.product.minimum | default: 36 %}
        <input type="hidden" id="minimumQty" value="{{ minimum_qty }}">
        <p class="sizes-subtitle">Minimum order quantity is {{ minimum_qty }} for all shirt colors & sizes, combined.</p>
        
        <div class="size-buttons" id="size-buttons">
          <button type="button" class="size-btn" data-size="XS">XS</button>
          <button type="button" class="size-btn" data-size="S">S</button>
          <button type="button" class="size-btn" data-size="M">M</button>
          <button type="button" class="size-btn" data-size="L">L</button>
          <button type="button" class="size-btn" data-size="XL">XL</button>
          <button type="button" class="size-btn" data-size="2XL">2XL</button>
          <button type="button" class="size-btn" data-size="3XL">3XL</button>
        </div>
        <div class="sizes-qty" id="sizes-qty"></div>
        <div class="sizes-minimum" id="sizes-minimum-status"></div>
        
        {% comment %} <div class="split-order">
          <label class="checkbox-option">
            <input type="checkbox" id="splitOrder">
            <span class="checkbox-label">Split my order into multiple shirt colors!</span>
          </label>
          <p class="split-note">Note: design AND ink colors must be the same on all shirts.</p>
        </div> {% endcomment %}
      </div>

      <!-- Order Notes -->
      <div class="notes-section">
        <h3 class="section-heading">Order Notes</h3>
        <textarea class="order-notes" placeholder="Add any special instructions or notes here..."></textarea>
      </div>

      <!-- Add to Cart Button -->
      <button type="button" class="add-to-cart-btn">Add to Cart</button>
    </div>
  </div>
</div>
